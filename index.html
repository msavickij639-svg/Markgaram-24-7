<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>MarkGram Live</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; display: flex; justify-content: center; padding-top: 50px; }
        .container { width: 400px; background: #1e1e1e; padding: 20px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        #chat { display: none; }
        input { width: 80%; padding: 10px; margin: 5px 0; border-radius: 5px; border: none; }
        button { padding: 10px 20px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; }
        #messages { height: 300px; overflow-y: auto; background: #2a2a2a; margin: 10px 0; padding: 10px; border-radius: 5px; }
        .msg { margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }
    </style>
</head>
<body>

<div class="container">
    <div id="login">
        <h2>Ð’Ñ…Ð¾Ð´ Ð² MarkGram</h2>
        <input type="text" id="username" placeholder="Ð¢Ð²Ð¾Ð¹ Ð½Ð¸Ðº">
        <button onclick="connect()">Ð’Ð¾Ð¹Ñ‚Ð¸</button>
    </div>

    <div id="chat">
        <h3 id="userLabel"></h3>
        <div id="messages"></div>
        <input type="text" id="msgInput" placeholder="Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ..." onkeypress="if(event.key==='Enter') send()">
        <button onclick="send()">ðŸ“¤</button>
    </div>
</div>

<script>
    let ws;
    let myName = "";

    function connect() {
        myName = document.getElementById('username').value;
        if (!myName) return;

        // Ð—ÐÐœÐ•ÐÐ˜ ÐÐ Ð¡Ð’ÐžÐ® Ð¡Ð¡Ð«Ð›ÐšÐ£ ÐžÐ¢ RAILWAY (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ws://Ñ‚Ð²Ð¾Ð¹-Ð¿Ñ€Ð¾ÐµÐºÑ‚.railway.app)
        ws = new WebSocket('ws://localhost:8080'); 

        ws.onopen = () => {
            document.getElementById('login').style.display = 'none';
            document.getElementById('chat').style.display = 'block';
            document.getElementById('userLabel').innerText = "ÐÐ¸Ðº: " + myName;
        };

        ws.onmessage = (event) => {
            const packet = JSON.parse(event.data);
            const msgDiv = document.createElement('div');
            msgDiv.className = 'msg';
            msgDiv.innerHTML = `<b>${packet.name}:</b> ${packet.text}`;
            document.getElementById('messages').appendChild(msgDiv);
            document.getElementById('messages').scrollTop = 100000;
        };
    }

    function send() {
        const input = document.getElementById('msgInput');
        if (input.value.trim() === "") return;

        const packet = { name: myName, text: input.value };
        ws.send(JSON.stringify(packet));
        input.value = "";
    }
</script>
</body>
</html>
